============================================================
Generating danger.txt from p0.07 q0.03 pruned model
============================================================

Found pruned model via symlink: temp/wandg_set_difference_usediff_False_recover_False -> /workspace/projects/2881r-mini-project/experiments/neuron/output/mode1_predefined_align_20251101_135213/p_0.07_q_0.03
Loading prompts from data/SFT_aligned_llama2-7b-chat-hf_train.csv...
Loaded 7197 prompts

Loading pruned model from /workspace/projects/2881r-mini-project/experiments/neuron/output/mode1_predefined_align_20251101_135213/p_0.07_q_0.03...
(This may take a few minutes)
INFO 11-02 16:10:44 llm_engine.py:72] Initializing an LLM engine with config: model='/workspace/projects/2881r-mini-project/experiments/neuron/output/mode1_predefined_align_20251101_135213/p_0.07_q_0.03', tokenizer='meta-llama/Llama-2-7b-chat-hf', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=1, quantization=None, seed=0)
INFO 11-02 16:10:44 tokenizer.py:31] For some LLaMA V1 models, initializing the fast tokenizer may take a long time. To reduce the initialization time, consider using 'hf-internal-testing/llama-tokenizer' instead of the original tokenizer.
INFO 11-02 16:11:12 llm_engine.py:207] # GPU blocks: 7457, # CPU blocks: 2048
✓ Model loaded

Generating completions for all prompts using all GCG strings...
Will select best response per prompt based on ASR.

Generating with GCG string 0...
Processed prompts:   0%|          | 0/7197 [00:00<?, ?it/s]Processed prompts:   0%|          | 1/7197 [00:13<26:22:36, 13.20s/it]Processed prompts:   4%|▎         | 257/7197 [00:26<10:06, 11.45it/s] Processed prompts:   7%|▋         | 513/7197 [00:39<07:23, 15.09it/s]Processed prompts:  11%|█         | 768/7197 [00:49<07:06, 15.09it/s]Processed prompts:  11%|█         | 769/7197 [00:52<06:24, 16.72it/s]Processed prompts:  14%|█▍        | 1025/7197 [01:06<05:50, 17.59it/s]Processed prompts:  18%|█▊        | 1281/7197 [01:19<05:25, 18.16it/s]Processed prompts:  21%|██▏       | 1536/7197 [01:30<05:11, 18.16it/s]Processed prompts:  21%|██▏       | 1537/7197 [01:33<05:07, 18.43it/s]Processed prompts:  25%|██▍       | 1793/7197 [01:46<04:49, 18.69it/s]Processed prompts:  28%|██▊       | 2049/7197 [01:59<04:33, 18.85it/s]Processed prompts:  32%|███▏      | 2304/7197 [02:10<04:19, 18.85it/s]Processed prompts:  32%|███▏      | 2305/7197 [02:13<04:18, 18.96it/s]Processed prompts:  36%|███▌      | 2561/7197 [02:19<03:24, 22.64it/s]Processed prompts:  36%|███▌      | 2581/7197 [02:26<04:10, 18.41it/s]Processed prompts:  39%|███▉      | 2817/7197 [02:32<03:14, 22.49it/s]Processed prompts:  39%|███▉      | 2837/7197 [02:39<04:09, 17.49it/s]Processed prompts:  43%|████▎     | 3073/7197 [02:46<03:04, 22.30it/s]Processed prompts:  43%|████▎     | 3093/7197 [02:53<04:04, 16.81it/s]Processed prompts:  46%|████▋     | 3329/7197 [02:59<02:55, 22.06it/s]Processed prompts:  47%|████▋     | 3349/7197 [03:06<03:53, 16.51it/s]Processed prompts:  50%|████▉     | 3585/7197 [03:13<02:44, 22.00it/s]Processed prompts:  50%|█████     | 3605/7197 [03:20<03:40, 16.29it/s]Processed prompts:  53%|█████▎    | 3841/7197 [03:26<02:33, 21.92it/s]Processed prompts:  54%|█████▎    | 3861/7197 [03:33<03:27, 16.10it/s]Processed prompts:  57%|█████▋    | 4097/7197 [03:40<02:20, 21.99it/s]Processed prompts:  57%|█████▋    | 4117/7197 [03:47<03:11, 16.07it/s]Processed prompts:  60%|██████    | 4353/7197 [03:53<02:09, 21.93it/s]Processed prompts:  61%|██████    | 4373/7197 [04:00<02:55, 16.14it/s]Processed prompts:  64%|██████▍   | 4609/7197 [04:07<01:57, 21.97it/s]Processed prompts:  64%|██████▍   | 4629/7197 [04:14<02:40, 16.03it/s]Processed prompts:  68%|██████▊   | 4865/7197 [04:20<01:46, 21.96it/s]Processed prompts:  68%|██████▊   | 4885/7197 [04:27<02:24, 16.05it/s]Processed prompts:  71%|███████   | 5121/7197 [04:34<01:34, 21.88it/s]Processed prompts:  71%|███████▏  | 5141/7197 [04:41<02:07, 16.07it/s]Processed prompts:  75%|███████▍  | 5377/7197 [04:47<01:23, 21.91it/s]Processed prompts:  75%|███████▍  | 5397/7197 [04:54<01:52, 16.03it/s]Processed prompts:  78%|███████▊  | 5633/7197 [05:01<01:11, 22.01it/s]Processed prompts:  79%|███████▊  | 5653/7197 [05:08<01:36, 16.08it/s]Processed prompts:  82%|████████▏ | 5889/7197 [05:14<00:59, 21.90it/s]Processed prompts:  82%|████████▏ | 5909/7197 [05:21<01:20, 16.02it/s]Processed prompts:  85%|████████▌ | 6145/7197 [05:28<00:47, 21.92it/s]Processed prompts:  86%|████████▌ | 6165/7197 [05:35<01:04, 15.98it/s]Processed prompts:  89%|████████▉ | 6401/7197 [05:41<00:36, 21.87it/s]Processed prompts:  89%|████████▉ | 6421/7197 [05:48<00:48, 15.96it/s]Processed prompts:  92%|█████████▏| 6657/7197 [05:55<00:24, 21.78it/s]Processed prompts:  93%|█████████▎| 6677/7197 [06:02<00:32, 15.89it/s]Processed prompts:  96%|█████████▌| 6913/7197 [06:09<00:13, 21.67it/s]Processed prompts:  96%|█████████▋| 6933/7197 [06:16<00:16, 15.88it/s]Processed prompts: 100%|█████████▉| 7169/7197 [06:17<00:01, 27.43it/s]Processed prompts: 100%|█████████▉| 7189/7197 [06:19<00:00, 25.80it/s]Processed prompts: 100%|██████████| 7197/7197 [06:19<00:00, 18.96it/s]
  ✓ Generated 7197 completions
Generating with GCG string 1...
Processed prompts:   0%|          | 0/7197 [00:00<?, ?it/s]Processed prompts:   0%|          | 1/7197 [00:13<27:07:47, 13.57s/it]Processed prompts:   4%|▎         | 257/7197 [00:27<10:33, 10.96it/s] Processed prompts:   7%|▋         | 512/7197 [00:39<10:09, 10.96it/s]Processed prompts:   7%|▋         | 513/7197 [00:41<07:41, 14.49it/s]Processed prompts:  11%|█         | 769/7197 [00:54<06:36, 16.22it/s]Processed prompts:  14%|█▍        | 1025/7197 [01:08<06:03, 16.98it/s]Processed prompts:  18%|█▊        | 1280/7197 [01:19<05:48, 16.98it/s]Processed prompts:  18%|█▊        | 1281/7197 [01:20<05:18, 18.58it/s]Processed prompts:  18%|█▊        | 1301/7197 [01:22<05:31, 17.79it/s]Processed prompts:  21%|██▏       | 1537/7197 [01:34<05:02, 18.68it/s]Processed prompts:  22%|██▏       | 1557/7197 [01:36<05:17, 17.77it/s]Processed prompts:  25%|██▍       | 1793/7197 [01:43<03:58, 22.68it/s]Processed prompts:  25%|██▌       | 1802/7197 [01:44<04:17, 20.97it/s]Processed prompts:  25%|██▌       | 1813/7197 [01:47<05:04, 17.71it/s]Processed prompts:  25%|██▌       | 1824/7197 [01:50<05:46, 15.52it/s]Processed prompts:  28%|██▊       | 2049/7197 [01:56<03:44, 22.96it/s]Processed prompts:  29%|██▊       | 2058/7197 [01:58<04:15, 20.15it/s]Processed prompts:  29%|██▊       | 2069/7197 [02:02<05:19, 16.07it/s]Processed prompts:  29%|██▉       | 2080/7197 [02:04<06:05, 14.02it/s]Processed prompts:  32%|███▏      | 2305/7197 [02:11<03:34, 22.83it/s]Processed prompts:  32%|███▏      | 2314/7197 [02:12<04:02, 20.10it/s]Processed prompts:  32%|███▏      | 2325/7197 [02:15<05:11, 15.66it/s]Processed prompts:  32%|███▏      | 2336/7197 [02:18<06:05, 13.30it/s]Processed prompts:  36%|███▌      | 2561/7197 [02:24<03:21, 22.97it/s]Processed prompts:  36%|███▌      | 2570/7197 [02:26<03:53, 19.78it/s]Processed prompts:  36%|███▌      | 2581/7197 [02:30<05:00, 15.39it/s]Processed prompts:  36%|███▌      | 2592/7197 [02:32<05:52, 13.08it/s]Processed prompts:  39%|███▉      | 2817/7197 [02:38<03:09, 23.07it/s]Processed prompts:  39%|███▉      | 2826/7197 [02:40<03:36, 20.21it/s]Processed prompts:  39%|███▉      | 2837/7197 [02:43<04:37, 15.71it/s]Processed prompts:  40%|███▉      | 2848/7197 [02:45<05:26, 13.31it/s]Processed prompts:  43%|████▎     | 3073/7197 [02:52<02:56, 23.36it/s]Processed prompts:  43%|████▎     | 3082/7197 [02:54<03:24, 20.09it/s]Processed prompts:  43%|████▎     | 3093/7197 [02:57<04:22, 15.62it/s]Processed prompts:  43%|████▎     | 3104/7197 [02:59<05:09, 13.22it/s]Processed prompts:  46%|████▋     | 3329/7197 [03:06<02:45, 23.34it/s]Processed prompts:  46%|████▋     | 3338/7197 [03:08<03:12, 20.09it/s]Processed prompts:  47%|████▋     | 3349/7197 [03:11<04:07, 15.53it/s]Processed prompts:  47%|████▋     | 3360/7197 [03:13<04:46, 13.40it/s]Processed prompts:  50%|████▉     | 3585/7197 [03:20<02:36, 23.01it/s]Processed prompts:  50%|████▉     | 3594/7197 [03:22<02:59, 20.13it/s]Processed prompts:  50%|█████     | 3605/7197 [03:25<03:50, 15.58it/s]Processed prompts:  50%|█████     | 3616/7197 [03:27<04:32, 13.12it/s]Processed prompts:  53%|█████▎    | 3841/7197 [03:34<02:25, 23.13it/s]Processed prompts:  53%|█████▎    | 3850/7197 [03:36<02:48, 19.89it/s]Processed prompts:  54%|█████▎    | 3861/7197 [03:39<03:35, 15.49it/s]Processed prompts:  54%|█████▍    | 3872/7197 [03:41<04:13, 13.13it/s]Processed prompts:  57%|█████▋    | 4097/7197 [03:48<02:13, 23.16it/s]Processed prompts:  57%|█████▋    | 4106/7197 [03:50<02:35, 19.88it/s]Processed prompts:  57%|█████▋    | 4117/7197 [03:53<03:19, 15.42it/s]Processed prompts:  57%|█████▋    | 4128/7197 [03:55<03:50, 13.33it/s]Processed prompts:  60%|██████    | 4353/7197 [04:02<02:03, 23.04it/s]Processed prompts:  61%|██████    | 4362/7197 [04:04<02:20, 20.17it/s]Processed prompts:  61%|██████    | 4373/7197 [04:07<03:01, 15.60it/s]Processed prompts:  61%|██████    | 4384/7197 [04:09<03:33, 13.16it/s]Processed prompts:  64%|██████▍   | 4609/7197 [04:16<01:53, 22.81it/s]Processed prompts:  64%|██████▍   | 4618/7197 [04:18<02:09, 19.99it/s]Processed prompts:  64%|██████▍   | 4629/7197 [04:21<02:45, 15.55it/s]Processed prompts:  64%|██████▍   | 4640/7197 [04:23<03:14, 13.18it/s]Processed prompts:  68%|██████▊   | 4865/7197 [04:30<01:40, 23.28it/s]Processed prompts:  68%|██████▊   | 4874/7197 [04:32<01:56, 20.02it/s]Processed prompts:  68%|██████▊   | 4885/7197 [04:35<02:28, 15.57it/s]Processed prompts:  68%|██████▊   | 4896/7197 [04:37<02:54, 13.18it/s]Processed prompts:  71%|███████   | 5121/7197 [04:43<01:29, 23.26it/s]Processed prompts:  71%|███████▏  | 5130/7197 [04:45<01:43, 20.02it/s]Processed prompts:  71%|███████▏  | 5141/7197 [04:48<02:12, 15.56it/s]Processed prompts:  72%|███████▏  | 5152/7197 [04:51<02:35, 13.18it/s]Processed prompts:  75%|███████▍  | 5377/7197 [04:57<01:18, 23.27it/s]Processed prompts:  75%|███████▍  | 5386/7197 [04:59<01:30, 20.02it/s]Processed prompts:  75%|███████▍  | 5397/7197 [05:02<01:55, 15.56it/s]Processed prompts:  75%|███████▌  | 5408/7197 [05:05<02:15, 13.18it/s]Processed prompts:  78%|███████▊  | 5633/7197 [05:11<01:07, 23.19it/s]Processed prompts:  78%|███████▊  | 5642/7197 [05:13<01:17, 19.96it/s]Processed prompts:  79%|███████▊  | 5653/7197 [05:16<01:39, 15.50it/s]Processed prompts:  79%|███████▊  | 5664/7197 [05:19<01:57, 13.08it/s]Processed prompts:  82%|████████▏ | 5889/7197 [05:25<00:57, 22.91it/s]Processed prompts:  82%|████████▏ | 5898/7197 [05:27<01:06, 19.65it/s]Processed prompts:  82%|████████▏ | 5909/7197 [05:31<01:24, 15.30it/s]Processed prompts:  82%|████████▏ | 5920/7197 [05:33<01:38, 12.95it/s]Processed prompts:  85%|████████▌ | 6145/7197 [05:40<00:45, 22.91it/s]Processed prompts:  86%|████████▌ | 6154/7197 [05:42<00:52, 19.73it/s]Processed prompts:  86%|████████▌ | 6165/7197 [05:45<01:07, 15.33it/s]Processed prompts:  86%|████████▌ | 6176/7197 [05:47<01:18, 13.01it/s]Processed prompts:  89%|████████▉ | 6401/7197 [05:54<00:34, 22.88it/s]Processed prompts:  89%|████████▉ | 6410/7197 [05:56<00:39, 19.73it/s]Processed prompts:  89%|████████▉ | 6421/7197 [05:59<00:50, 15.31it/s]Processed prompts:  89%|████████▉ | 6432/7197 [06:01<00:58, 13.01it/s]Processed prompts:  92%|█████████▏| 6657/7197 [06:08<00:23, 23.00it/s]Processed prompts:  93%|█████████▎| 6666/7197 [06:10<00:26, 19.74it/s]Processed prompts:  93%|█████████▎| 6677/7197 [06:13<00:33, 15.34it/s]Processed prompts:  93%|█████████▎| 6688/7197 [06:15<00:39, 12.98it/s]Processed prompts:  96%|█████████▌| 6913/7197 [06:22<00:12, 22.88it/s]Processed prompts:  96%|█████████▌| 6922/7197 [06:24<00:13, 19.68it/s]Processed prompts:  96%|█████████▋| 6933/7197 [06:27<00:17, 15.35it/s]Processed prompts:  96%|█████████▋| 6944/7197 [06:29<00:19, 13.06it/s]Processed prompts: 100%|█████████▉| 7169/7197 [06:31<00:00, 35.55it/s]Processed prompts: 100%|█████████▉| 7178/7197 [06:31<00:00, 34.13it/s]Processed prompts: 100%|█████████▉| 7189/7197 [06:32<00:00, 31.94it/s]Processed prompts: 100%|██████████| 7197/7197 [06:32<00:00, 18.33it/s]
  ✓ Generated 7197 completions
Generating with GCG string 2...
Processed prompts:   0%|          | 0/7197 [00:00<?, ?it/s]Processed prompts:   0%|          | 1/7197 [00:13<27:25:25, 13.72s/it]Processed prompts:   4%|▎         | 257/7197 [00:27<10:27, 11.06it/s] Processed prompts:   7%|▋         | 513/7197 [00:41<07:39, 14.55it/s]Processed prompts:  11%|█         | 769/7197 [00:54<06:38, 16.15it/s]Processed prompts:  14%|█▍        | 1024/7197 [01:06<06:22, 16.15it/s]Processed prompts:  14%|█▍        | 1025/7197 [01:08<06:02, 17.04it/s]Processed prompts:  18%|█▊        | 1281/7197 [01:22<05:35, 17.65it/s]Processed prompts:  21%|██▏       | 1537/7197 [01:36<05:16, 17.90it/s]Processed prompts:  25%|██▍       | 1793/7197 [01:45<04:29, 20.07it/s]Processed prompts:  25%|██▌       | 1813/7197 [01:49<04:56, 18.13it/s]Processed prompts:  28%|██▊       | 2049/7197 [01:59<04:17, 19.96it/s]Processed prompts:  29%|██▊       | 2069/7197 [02:03<04:50, 17.66it/s]Processed prompts:  32%|███▏      | 2305/7197 [02:13<04:04, 19.97it/s]Processed prompts:  32%|███▏      | 2325/7197 [02:17<04:42, 17.27it/s]Processed prompts:  36%|███▌      | 2561/7197 [02:27<03:54, 19.81it/s]Processed prompts:  36%|███▌      | 2581/7197 [02:31<04:29, 17.13it/s]Processed prompts:  39%|███▉      | 2817/7197 [02:40<03:40, 19.89it/s]Processed prompts:  39%|███▉      | 2837/7197 [02:45<04:17, 16.95it/s]Processed prompts:  43%|████▎     | 3073/7197 [02:54<03:28, 19.78it/s]Processed prompts:  43%|████▎     | 3093/7197 [02:58<04:01, 16.98it/s]Processed prompts:  46%|████▋     | 3329/7197 [03:08<03:16, 19.69it/s]Processed prompts:  47%|████▋     | 3349/7197 [03:12<03:47, 16.95it/s]Processed prompts:  50%|████▉     | 3585/7197 [03:22<03:02, 19.84it/s]Processed prompts:  50%|█████     | 3605/7197 [03:26<03:33, 16.83it/s]Processed prompts:  53%|█████▎    | 3841/7197 [03:36<02:49, 19.75it/s]Processed prompts:  54%|█████▎    | 3861/7197 [03:40<03:16, 17.00it/s]Processed prompts:  57%|█████▋    | 4097/7197 [03:50<02:36, 19.78it/s]Processed prompts:  57%|█████▋    | 4117/7197 [03:54<03:01, 16.98it/s]Processed prompts:  60%|██████    | 4353/7197 [04:04<02:23, 19.79it/s]Processed prompts:  61%|██████    | 4373/7197 [04:08<02:45, 17.04it/s]Processed prompts:  64%|██████▍   | 4609/7197 [04:17<02:09, 19.92it/s]Processed prompts:  64%|██████▍   | 4629/7197 [04:21<02:30, 17.12it/s]Processed prompts:  68%|██████▊   | 4865/7197 [04:31<01:56, 20.05it/s]Processed prompts:  68%|██████▊   | 4885/7197 [04:35<02:16, 16.99it/s]Processed prompts:  71%|███████   | 5121/7197 [04:45<01:44, 19.96it/s]Processed prompts:  71%|███████▏  | 5141/7197 [04:49<02:00, 16.99it/s]Processed prompts:  75%|███████▍  | 5377/7197 [04:59<01:31, 19.96it/s]Processed prompts:  75%|███████▍  | 5397/7197 [05:03<01:46, 16.92it/s]Processed prompts:  78%|███████▊  | 5633/7197 [05:13<01:18, 19.87it/s]Processed prompts:  79%|███████▊  | 5653/7197 [05:17<01:31, 16.93it/s]Processed prompts:  82%|████████▏ | 5889/7197 [05:26<01:05, 19.90it/s]Processed prompts:  82%|████████▏ | 5909/7197 [05:31<01:15, 16.95it/s]Processed prompts:  85%|████████▌ | 6145/7197 [05:40<00:52, 20.00it/s]Processed prompts:  86%|████████▌ | 6165/7197 [05:44<01:00, 16.96it/s]Processed prompts:  89%|████████▉ | 6401/7197 [05:54<00:40, 19.84it/s]Processed prompts:  89%|████████▉ | 6421/7197 [05:55<00:38, 20.39it/s]Processed prompts:  89%|████████▉ | 6427/7197 [05:58<00:47, 16.11it/s]Processed prompts:  92%|█████████▏| 6657/7197 [06:08<00:27, 19.42it/s]Processed prompts:  93%|█████████▎| 6677/7197 [06:08<00:25, 20.30it/s]Processed prompts:  93%|█████████▎| 6683/7197 [06:12<00:32, 15.61it/s]Processed prompts:  93%|█████████▎| 6703/7197 [06:12<00:28, 17.25it/s]Processed prompts:  96%|█████████▌| 6913/7197 [06:22<00:14, 19.76it/s]Processed prompts:  96%|█████████▋| 6933/7197 [06:22<00:12, 20.86it/s]Processed prompts:  96%|█████████▋| 6939/7197 [06:25<00:15, 16.36it/s]Processed prompts:  97%|█████████▋| 6959/7197 [06:26<00:14, 16.98it/s]Processed prompts:  97%|█████████▋| 6979/7197 [06:26<00:10, 19.88it/s]Processed prompts: 100%|█████████▉| 7169/7197 [06:29<00:00, 39.06it/s]Processed prompts: 100%|█████████▉| 7195/7197 [06:29<00:00, 39.58it/s]Processed prompts: 100%|██████████| 7197/7197 [06:29<00:00, 18.46it/s]
  ✓ Generated 7197 completions

Selecting best completion per prompt based on ASR...
✓ Selected 7197 best completions

Saving to data/danger.txt...
✓ Saved 7197 prompt-completion pairs to data/danger.txt

============================================================
Generation complete!
============================================================
